<!--  å¤©æœä¸Šå®ï¼ˆå¾¡èµå€¼ï¼‰ -->
<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>å¤©æœä¸Šå®ï¼ˆå¾¡èµå€¼ï¼‰è®¡ç®—</title>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <style>
      .info-panel {
        margin-top: 30px;
        padding: 20px;
        background-color: #f7f7f7;
        border-radius: 8px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .info-panel h2 {
        font-size: 22px;
        color: #333;
        margin-bottom: 15px;
      }
      .info-panel p {
        font-size: 16px;
        color: #555;
        line-height: 1.8;
        text-align: left;
      }
      .result {
        white-space: pre-line;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <button
        class="back-home-button"
        onclick="window.location.href='index.html'"
      >
        å›åˆ°é¦–é¡µ
      </button>

      <h1>
        å¤©æœä¸Šå®ï¼ˆå¾¡èµå€¼ï¼‰è®¡ç®—<br />
        <a
          href="#tutorial"
          style="
            font-size: 14px;
            color: #1a73e8;
            text-decoration: underline;
            cursor: pointer;
          "
        >
          â¡ï¸ğŸ‘‰ ç¬¬ä¸€æ¬¡ä½¿ç”¨è¯·ç‚¹æˆ‘æŸ¥çœ‹è¯´æ˜æ•™ç¨‹ ğŸ‘ˆâ¬…ï¸
        </a>
      </h1>

      <div class="input-container">
        <label for="currentScoreWan">ç°æœ‰çš„å¾¡èµå€¼ï¼ˆä¸‡ï¼‰ï¼š</label>
        <input
          type="number"
          id="currentScoreWan"
          placeholder="ä¾‹å¦‚: 1.25"
          min="0"
          step="0.01"
        />
      </div>

      <div class="input-container">
        <label for="targetScoreWan">ç›®æ ‡å¾¡èµå€¼ï¼ˆä¸‡ï¼‰ï¼š</label>
        <input
          type="number"
          id="targetScoreWan"
          placeholder="ä¾‹å¦‚: 1.85 æˆ– 15.27"
          min="0"
          step="0.01"
        />
      </div>

      <div class="input-container">
        <label for="distancePerRound">æ¯è½®é‡Œç¨‹ï¼ˆé‡Œï¼‰ï¼š</label>
        <input
          type="number"
          id="distancePerRound"
          placeholder="ä¾‹å¦‚: 4800"
          min="1"
        />
      </div>

      <div class="input-container">
        <label for="speed">è‡ªå·±è½¦å­çš„é€Ÿåº¦ï¼š</label>
        <input type="number" id="speed" placeholder="ä¾‹å¦‚: 300" min="1" />
      </div>

      <div class="input-container">
        <label for="cityCount">æ¯è½®å›ºå®šè·¯çº¿çš„åŸæ± æ•°é‡ï¼š</label>
        <input type="number" id="cityCount" placeholder="ä¾‹å¦‚: 2" min="0" />
      </div>

      <div class="input-container">
        <label for="bunCount">å·²æœ‰çš„è”åŠ›é¥¼æ•°é‡ï¼š</label>
        <input type="number" id="bunCount" placeholder="ä¾‹å¦‚: 12345" min="0" />
      </div>

      <button onclick="calcTCSB()">è®¡ç®—å¾¡èµå€¼</button>

      <div class="result" id="result"></div>

      <div class="info-panel" id="tutorial">
        <h2>è¯´æ˜</h2>
        <p>
          <strong>å‰æï¼š</strong>
          å·²å¼€é€šäº†12å…ƒçš„â€œå…«æ–¹èšè´¢â€ç‰¹æƒï¼Œå³å¯ä»¥ä½¿ç”¨ã€è‡ªåŠ¨è´¸æ˜“ã€‘åŠŸèƒ½ï¼
        </p>
        <p>
          <strong>æ¯è½®é‡Œç¨‹ï¼š</strong>
          æ‰“å¼€â€œè‡ªåŠ¨è´¸æ˜“â€ç•Œé¢ï¼Œé€‰æ‹©å›ºå®šè·¯çº¿åï¼Œç‚¹å‡»æŸåº§åŸå³ä¸Šè§’çš„é»„è‰²é”¯é½¿ï¼Œç•Œé¢çš„æ­£ä¸Šæ–¹â€œæ¯è½®è´¸æ˜“â€å¤„ï¼Œæœ‰æ¯è½®é‡Œç¨‹ä¿¡æ¯ã€‚
        </p>
        <p>
          <strong>æ¯è½®å›ºå®šè·¯çº¿çš„åŸæ± æ•°é‡ï¼š</strong>
          æ‰“å¼€â€œè‡ªåŠ¨è´¸æ˜“â€ç•Œé¢ï¼Œé€‰æ‹©å›ºå®šè·¯çº¿åï¼Œè®¾ç½®äº†å‡ åº§åŸå°±å¡«å‡ ï¼Œä¾‹å¦‚ï¼šä¸´æµ·-é’å·ï¼Œå°±æ˜¯2åº§åŸã€‚
        </p>
        <p>
          <strong>è‡ªå·±è½¦å­çš„é€Ÿåº¦ï¼š</strong>
          æ‰“å¼€â€œå•†é˜Ÿâ€ç•Œé¢ï¼ˆæ¯å¤©çœ‹å¹¿å‘Šé¢†è”åŠ›é¥¼çš„åœ°æ–¹çš„å³è¾¹å°±æ˜¯ï¼‰ï¼Œåœ¨å±æ€§è¯¦æƒ…å¤„å¯çœ‹åˆ°é€Ÿåº¦ã€‚
        </p>
        <p>
          <strong>è¯¯å·®è¯´æ˜ï¼š</strong>
          ç»“æœä¸ºæœŸæœ›å€¼ï¼Œå®é™…ä¼šæœ‰æ³¢åŠ¨ï¼Œç®—æ³•å·²ä¼˜åŒ–ï¼Œè¯¯å·®7%å·¦å³ï¼Œå—æ¦‚ç‡å½±å“æœ¬å€¼ä»…ä¾›å‚è€ƒã€‚
        </p>
      </div>
    </div>

    <script>
      function calcTCSB() {
        const currentScoreWan =
          parseFloat(document.getElementById("currentScoreWan").value) || 0;
        const targetRaw = (
          document.getElementById("targetScoreWan").value || ""
        ).trim();
        const hasTarget = targetRaw !== "";
        const targetScoreWan = hasTarget ? parseFloat(targetRaw) || 0 : 0;

        const routeDistance =
          parseFloat(document.getElementById("distancePerRound").value) || 0;
        const caravanSpeed =
          parseFloat(document.getElementById("speed").value) || 0;
        const cityCount =
          parseFloat(document.getElementById("cityCount").value) || 0;
        const bunsOwned =
          parseFloat(document.getElementById("bunCount").value) || 0;

        const resultEl = document.getElementById("result");

        if (
          routeDistance <= 0 ||
          caravanSpeed <= 0 ||
          currentScoreWan < 0 ||
          (!hasTarget ? false : targetScoreWan < 0) ||
          cityCount < 0 ||
          bunsOwned < 0
        ) {
          resultEl.innerText =
            "è¯·æ£€æŸ¥è¾“å…¥ï¼šé‡Œç¨‹/é€Ÿåº¦éœ€ä¸ºæ­£æ•°ï¼Œå…¶ä½™ä¸ºä¸å°äº 0 çš„æ•°å­—ã€‚";
          return;
        }

        const currentScore = currentScoreWan * 10000;
        const targetScore = targetScoreWan * 10000;

        const pointsPerDraw = 470;
        const timePerTrip = routeDistance / caravanSpeed + cityCount;
        if (timePerTrip <= 0) {
          resultEl.innerText = "å‚æ•°å¼‚å¸¸ï¼šå•æ¬¡æ—¶é—´éœ€å¤§äº 0ã€‚";
          return;
        }

        const pointsPerBun =
          (routeDistance / 1000 / timePerTrip) * pointsPerDraw;
        const totalTrips = bunsOwned / 2;
        const totalDistanceK =
          (totalTrips / timePerTrip) * (routeDistance / 1000);
        const gainScore = totalDistanceK * pointsPerDraw;
        const finalScore = currentScore + gainScore;

        const gainScoreWan = gainScore / 10000;
        const finalScoreWan = finalScore / 10000;

        if (!hasTarget) {
          resultEl.innerText =
            `è¿˜å¯ä»¥å¾—åˆ°çš„å¾¡èµå€¼ï¼š${gainScoreWan.toFixed(2)} ä¸‡\n` +
            `æœ€ç»ˆä¼°ç®—çš„å¾¡èµå€¼ï¼š${finalScoreWan.toFixed(2)} ä¸‡`;
          return;
        }

        if (finalScore >= targetScore) {
          resultEl.innerText =
            `è¿˜å¯ä»¥å¾—åˆ°çš„å¾¡èµå€¼ï¼š${gainScoreWan.toFixed(2)} ä¸‡\n` +
            `æœ€ç»ˆä¼°ç®—çš„å¾¡èµå€¼ï¼š${finalScoreWan.toFixed(2)} ä¸‡\n` +
            `ç»“è®ºï¼šå·²è¶³å¤Ÿè¾¾åˆ°ç›®æ ‡ï¼Œæ— éœ€è¡¥å……è”åŠ›é¥¼ã€‚`;
        } else {
          const scoreNeeded = targetScore - currentScore;
          const additionalBunsRaw =
            2 * (scoreNeeded / pointsPerBun) - bunsOwned;
          const additionalBuns = Math.max(0, Math.ceil(additionalBunsRaw));
          resultEl.innerText =
            `è¿˜å¯ä»¥å¾—åˆ°çš„å¾¡èµå€¼ï¼š${gainScoreWan.toFixed(2)} ä¸‡\n` +
            `æœ€ç»ˆä¼°ç®—çš„å¾¡èµå€¼ï¼š${finalScoreWan.toFixed(2)} ä¸‡\n` +
            `â¡ï¸ ä»éœ€è¡¥å……çš„è”åŠ›é¥¼ï¼š${additionalBuns.toLocaleString("zh-CN")} ä¸ª`;
        }
      }
    </script>
  </body>
</html>
